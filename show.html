<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Show Data</title>
<style>
  body, html {
    height: 100%;
    margin: 0;
    background: url('https://c4.wallpaperflare.com/wallpaper/888/472/932/miside-mita-miside-in-bed-hd-wallpaper-preview.jpg') no-repeat center center fixed; 
    background-size: cover;
    font-family: sans-serif;
  }
  .table-box {
    background: rgba(255, 255, 255, 0.7);
    width: 80%;
    margin: auto;
    margin-top: 5%;
    padding: 20px;
    border-radius: 10px;
    overflow-x: auto;
  }
  table { width: 100%; border-collapse: collapse; }
  th, td { border: 1px solid #000; padding: 8px; text-align: center; }
</style>
<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbyL0nvFw9svQb3BoXT45o_s66WSRg4lj1QqybDKFMr2W3A6BLNuLO8ZUukKZjHzxssJoQ/exec";

window.onload = () => {
  fetch(scriptURL + "?action=list")
    .then(res => res.json())
    .then(data => {
      let html = "<tr><th>ชื่อ - นามสกุล</th><th>เลขนักศึกษา</th><th>อีเมล</th><th>วันที่</th></tr>";
      data.slice(1).forEach(row => {
        html += `<tr>
          <td>${row[0]}</td>
          <td>${row[1]}</td>
          <td>${row[2]}</td>
          <td>${row[3]}</td>
        </tr>`;
      });
      document.getElementById("tableBody").innerHTML = html;
    });
};
</script>
</head>
<body>
  <div class="table-box">
    <button onclick="location.href='index.html'">กลับหน้าหลัก</button>
    <button onclick="location.href='data.html'">กรอกข้อมูล</button>
    <h2>ข้อมูลจาก Google Sheet</h2>
    <table>
      <tbody id="tableBody"></tbody>
    </table>
  </div>
</body>
</html>
